<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="./img/favicon.ico">

        <title>Jerry Analytics</title>

        <link href="./css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="./css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="./css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="./css/highlight.css">

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->

        
    </head>

    <body class="homepage">

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            

            <!-- Main title -->
            <a class="navbar-brand" href=".">Jerry Analytics</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            

            
        </div>
    </div>
</div>

        <div class="container">
            
                <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#jerry-analytics">Jerry Analytics</a></li>
        
            <li><a href="#prepare-jsonp-module">Prepare: JSONP Module</a></li>
        
            <li><a href="#usage-sample">Usage Sample</a></li>
        
            <li><a href="#api">API</a></li>
        
            <li><a href="#1-increment">1. increment</a></li>
        
            <li><a href="#2-get">2. get</a></li>
        
            <li><a href="#3-gettop">3. getTop</a></li>
        
            <li><a href="#4-getbydomain">4. getByDomain</a></li>
        
    
    </ul>
</div></div>
                <div class="col-md-9" role="main">

<h1 id="jerry-analytics">Jerry Analytics</h1>
<p>Jerry Analytics is a simple data collector for visit statistics.</p>
<ul>
<li><a href="#prepare-jsonp-module">Prepare: JSONP Module</a></li>
<li><a href="#usage-sample">Usage Sample</a></li>
<li><a href="#api">API</a></li>
</ul>
<h2 id="prepare-jsonp-module">Prepare: JSONP Module</h2>
<p>Create a module for sending jsonp</p>
<pre><code>var jsonp = function(url, args) {
    var head = document.head,
        script = document.createElement(&quot;script&quot;),
        first = true,
        value;

    for (var key in args) {
        if (args.hasOwnProperty(key)) {
            value = encodeURIComponent(args[key]);
            url += first ? ('?' + key + '=' + value) : ('&amp;' + key + '=' + value);
            first = false;
        }
    }
    script.src= url;
    head.appendChild(script);
}
</code></pre>

<h2 id="usage-sample">Usage Sample</h2>
<p>Send <code>JSONP</code> requests to <code>http://analytics1.sinaapp.com/page.php</code></p>
<h3 id="1-increase-the-count-of-a-visited-page">1. Increase the count of a visited page</h3>
<pre><code>jsonp('http://analytics1.sinaapp.com/page.php', {
    callback: 'func',
    type: 'increment',
    domain: 'http://jerryzou.com',
    url: 'http://jerryzou.com/posts/aboutNormalizeCss/',
    title: 'About Normalize.css'
});

//callback
function func(result) {
    console.log(result.url, result.count);
}
</code></pre>

<h3 id="2-get-the-count-of-several-pages">2. Get the count of several pages</h3>
<pre><code>jsonp('http://analytics1.sinaapp.com/page.php', {
    callback: 'func',
    type: 'get',
    pages: JSON.stringify([
        { domain: &quot;http://jerryzou.com&quot;, url: &quot;http://jerryzou.com/posts/aboutNormalizeCss/&quot; },
        { domain: &quot;http://jerryzou.com&quot;, url: &quot;http://jerryzou.com/about/&quot; },
    ])
});

//callback
function func(result) {
    for (var i = 0; i &lt; result.length; i++) {
        console.log(result[i].url, result[i].count);
    }
}
</code></pre>

<h3 id="3-get-the-pages-which-have-been-mostly-visited">3. Get the pages which have been mostly visited</h3>
<pre><code>jsonp('http://analytics1.sinaapp.com/page.php', {
    callback: 'func',
    type: 'getTop',
    domain: 'http://jerryzou.com',
    number: '5'
});

//callback
function func(result) {
    for (var i = 0; i &lt; result.length; i++) {
        console.log(result[i].title, result[i].count);
    }
}
</code></pre>

<h3 id="4-get-all-pages-under-the-given-domain">4. Get all pages under the given domain</h3>
<pre><code>jsonp('http://analytics1.sinaapp.com/page.php', {
    callback: 'func',
    type: 'getByDomain',
    domain: 'http://jerryzou.com'
});

//callback
function func(result) {
    for (var i = 0; i &lt; result.length; i++) {
        console.log(result[i].title, result[i].count);
    }
}
</code></pre>

<h2 id="api">API</h2>
<h2 id="1-increment">1. increment</h2>
<p>When someone visit your website, increase the count of a visited page.</p>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Value</th>
<th>Requirement</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>increment</td>
<td>Required</td>
<td>-</td>
</tr>
<tr>
<td>callback</td>
<td>jsonp_callback</td>
<td>Required</td>
<td>The callback will be called when the jsonp request returns.</td>
</tr>
<tr>
<td>domain</td>
<td>http://a.com</td>
<td>Required</td>
<td>domain of your site</td>
</tr>
<tr>
<td>url</td>
<td>http://a.com/page/</td>
<td>Required</td>
<td>url of current page</td>
</tr>
<tr>
<td>title</td>
<td>Hello, Everyone</td>
<td>Required</td>
<td>page title</td>
</tr>
</tbody>
</table>
<h4 id="api_1">API</h4>
<pre><code>page.php?type=increment
</code></pre>

<h4 id="request-sample">Request Sample</h4>
<pre><code>http://analytics1.sinaapp.com/page.php?callback=jsonp_callback&amp;type=increment&amp;domain=http%3A%2F%2Fjerryzou.com&amp;url=http%3A%2F%2Fjerryzou.com%2Fposts%2FaboutNormalizeCss%2F&amp;title=About%20Normalize.css
</code></pre>

<h4 id="response-sample">Response Sample</h4>
<pre><code>jsonp_callback({
    &quot;domain&quot;: &quot;http://jerryzou.com&quot;,
    &quot;url&quot;: &quot;http://jerryzou.com/posts/aboutNormalizeCss/&quot;,
    &quot;count&quot;: 2443,
    &quot;title&quot;: &quot;About Normalize.css&quot;
});
</code></pre>

<h2 id="2-get">2. get</h2>
<p>Get the count of several pages.</p>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Value</th>
<th>Requirement</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>get</td>
<td>Required</td>
<td>-</td>
</tr>
<tr>
<td>callback</td>
<td>jsonp_callback</td>
<td>Required</td>
<td>The callback will be called when the jsonp request returns.</td>
</tr>
<tr>
<td>pages</td>
<td>(see the <a href="#2-get-the-count-of-several-pages">sample below</a>)</td>
<td>Required</td>
<td>an array contains the domains and urls of several pages</td>
</tr>
</tbody>
</table>
<h4 id="api_2">API</h4>
<pre><code>page.php?type=get
</code></pre>

<h4 id="request-sample_1">Request Sample</h4>
<pre><code>http://analytics1.sinaapp.com/page.php?callback=jsonp_callback&amp;type=get&amp;pages=%5B%7B%22domain%22%3A%22http%3A%2F%2Fjerryzou.com%22%2C%22url%22%3A%22http%3A%2F%2Fjerryzou.com%2Fposts%2FaboutNormalizeCss%2F%22%7D%2C%7B%22domain%22%3A%22http%3A%2F%2Fjerryzou.com%22%2C%22url%22%3A%22http%3A%2F%2Fjerryzou.com%2Fabout%2F%22%7D%5D
</code></pre>

<p><strong>Notice</strong>: The length of the url of jsonp request should be limited to <strong>1024</strong>, because the request method that jsonp uses is <code>GET</code>.</p>
<h4 id="response-sample_1">Response Sample</h4>
<pre><code>jsonp_callback([
    {
        &quot;domain&quot;: &quot;http://jerryzou.com&quot;,
        &quot;url&quot;: &quot;http://jerryzou.com/posts/aboutNormalizeCss/&quot;,
        &quot;title&quot;: &quot;About Normalize.css&quot;,
        &quot;count&quot;: 2443
    }, {
        &quot;domain&quot;: &quot;http://jerryzou.com&quot;,
        &quot;url&quot;: &quot;http://jerryzou.com/about/&quot;,
        &quot;title&quot;: &quot;About Me&quot;,
        &quot;count&quot;: 0
    }
]);
</code></pre>

<h2 id="3-gettop">3. getTop</h2>
<p>Get the pages which have been mostly visited.</p>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Value</th>
<th>Requirement</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>getTop</td>
<td>Required</td>
<td>-</td>
</tr>
<tr>
<td>callback</td>
<td>jsonp_callback</td>
<td>Required</td>
<td>The callback will be called when the jsonp request returns.</td>
</tr>
<tr>
<td>domain</td>
<td>http://a.com</td>
<td>Required</td>
<td>domain of your site</td>
</tr>
<tr>
<td>number</td>
<td>5</td>
<td>Required</td>
<td>get top 5 pages</td>
</tr>
</tbody>
</table>
<h4 id="api_3">API</h4>
<pre><code>page.php?type=getTop
</code></pre>

<h4 id="request-sample_2">Request Sample</h4>
<pre><code>http://analytics1.sinaapp.com/page.php?callback=jsonp_callback&amp;type=getTop&amp;domain=http%3A%2F%2Fjerryzou.com&amp;number=5
</code></pre>

<h4 id="response-sample_2">Response Sample</h4>
<pre><code>jsonp_callback([
    {
        &quot;url&quot;: &quot;http://jerryzou.com/posts/aboutNormalizeCss/&quot;,
        &quot;title&quot;: &quot;&quot;,
        &quot;count&quot;: 2443
    }, {
        &quot;url&quot;: &quot;http://jerryzou.com/posts/shadowsocks-with-digitalocean/&quot;,
        &quot;title&quot;: &quot;&quot;,
        &quot;count&quot;: 1123
    }, {
        &quot;url&quot;: &quot;http://jerryzou.com/posts/sjtuBusFeedback/&quot;,
        &quot;title&quot;: &quot;&quot;,
        &quot;count&quot;: 488
    }, {
        &quot;url&quot;: &quot;http://jerryzou.com/posts/bulkUploadToUPYUN/&quot;,
        &quot;title&quot;: &quot;&quot;,
        &quot;count&quot;: 437
    }, {
        &quot;url&quot;: &quot;http://jerryzou.com/posts/usePygments/&quot;,
        &quot;title&quot;: &quot;&quot;,
        &quot;count&quot;: 274
    }
]);
</code></pre>

<h2 id="4-getbydomain">4. getByDomain</h2>
<p>Get all pages under the given domain.</p>
<table>
<thead>
<tr>
<th>Argument</th>
<th>Value</th>
<th>Requirement</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>type</td>
<td>getByDomain</td>
<td>Required</td>
<td>-</td>
</tr>
<tr>
<td>callback</td>
<td>jsonp_callback</td>
<td>Required</td>
<td>The callback will be called when the jsonp request returns.</td>
</tr>
<tr>
<td>domain</td>
<td>http://a.com</td>
<td>Required</td>
<td>domain of your site</td>
</tr>
</tbody>
</table>
<h4 id="api_4">API</h4>
<pre><code>page.php?type=getByDomain
</code></pre>

<h4 id="request-sample_3">Request Sample</h4>
<pre><code>http://analytics1.sinaapp.com/page.php?callback=jsonp_callback&amp;type=getByDomain&amp;domain=http%3A%2F%2Fjerryzou.com
</code></pre>

<h4 id="response-sample_3">Response Sample</h4>
<pre><code>jsonp_callback([
    {
        &quot;url&quot;: &quot;http://jerryzou.com/posts/aboutNormalizeCss/&quot;,
        &quot;title&quot;: &quot;&quot;,
        &quot;count&quot;: 2443
    }, {
        &quot;url&quot;: &quot;http://jerryzou.com/posts/shadowsocks-with-digitalocean/&quot;,
        &quot;title&quot;: &quot;&quot;,
        &quot;count&quot;: 1123
    }, {
        &quot;url&quot;: &quot;http://jerryzou.com/posts/sjtuBusFeedback/&quot;,
        &quot;title&quot;: &quot;&quot;,
        &quot;count&quot;: 488
    }, {
        &quot;url&quot;: &quot;http://jerryzou.com/posts/bulkUploadToUPYUN/&quot;,
        &quot;title&quot;: &quot;&quot;,
        &quot;count&quot;: 437
    }, {
        &quot;url&quot;: &quot;http://jerryzou.com/posts/usePygments/&quot;,
        &quot;title&quot;: &quot;&quot;,
        &quot;count&quot;: 274
    },
    ...
]);
</code></pre>

</div>
            
        </div>

        <footer class="col-md-12">
            <hr>
            
            <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>

        

        <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
        <script src="./js/bootstrap-3.0.3.min.js"></script>
        <script src="./js/prettify-1.0.min.js"></script>
        <script src="./js/highlight.pack.js"></script>
        <script src="./js/base.js"></script>
    </body>
</html>